<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Iterative Refinement · LazySets.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><link href="../assets/juliareach.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="LazySets.jl logo"/></a><h1>LazySets.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="getting_started.html">Getting Started</a></li><li><a class="toctext" href="polyhedral_approximations.html">Polyhedral Approximations</a></li><li><a class="toctext" href="decompose_example.html">Decomposing an Affine Map</a></li><li><a class="toctext" href="fast_2d_LPs.html">Fast 2D LPs</a></li><li class="current"><a class="toctext" href="iterative_refinement.html">Iterative Refinement</a><ul class="internal"><li><a class="toctext" href="#Local-approximations-1">Local approximations</a></li><li><a class="toctext" href="#Initialization-1">Initialization</a></li><li><a class="toctext" href="#Iteration-1">Iteration</a></li><li><a class="toctext" href="#Stopping-criteria-1">Stopping criteria</a></li><li><a class="toctext" href="#Examples-1">Examples</a></li></ul></li><li><a class="toctext" href="interval_hulls.html">Interval Hulls</a></li><li><a class="toctext" href="convex_hulls.html">Convex Hulls</a></li><li><a class="toctext" href="reach_zonotopes.html">A Reachability Algorithm</a></li></ul></li><li><span class="toctext">Library</span><ul><li><a class="toctext" href="../lib/interfaces.html">Set Interfaces</a></li><li><a class="toctext" href="../lib/representations.html">Common Set Representations</a></li><li><a class="toctext" href="../lib/operations.html">Common Set Operations</a></li><li><a class="toctext" href="../lib/approximations.html">Approximations</a></li><li><a class="toctext" href="../lib/utils.html">Utility Functions</a></li></ul></li><li><a class="toctext" href="../about.html">About</a></li></ul></nav><article id="docs"><header><nav><ul><li>Manual</li><li><a href="iterative_refinement.html">Iterative Refinement</a></li></ul><a class="edit-page" href="https://github.com/JuliaReach/LazySets.jl/blob/master/docs/src/man/iterative_refinement.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Iterative Refinement</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Iterative-Refinement-1" href="#Iterative-Refinement-1">Iterative Refinement</a></h1><p>This section of the manual describes an approximation method for an arbitrary two-dimensional convex set <span>$S$</span> and a given error bound <span>$ɛ$</span> using support vectors.</p><ul><li><a href="iterative_refinement.html#Iterative-Refinement-1">Iterative Refinement</a></li><ul><li><a href="iterative_refinement.html#Local-approximations-1">Local approximations</a></li><li><a href="iterative_refinement.html#Initialization-1">Initialization</a></li><li><a href="iterative_refinement.html#Iteration-1">Iteration</a></li><li><a href="iterative_refinement.html#Stopping-criteria-1">Stopping criteria</a></li><li><a href="iterative_refinement.html#Examples-1">Examples</a></li></ul></ul><p>The basic idea is to add new supporting directions whenever the approximation error is still bigger than <span>$ɛ$</span>.</p><h2><a class="nav-anchor" id="Local-approximations-1" href="#Local-approximations-1">Local approximations</a></h2><p>The approximation is represented by a list of local approximations or refinements. Each refinement describes a set with one angle. More precisely, a <em>local approximation</em> is a triple <span>$(p_1, p_2, q)$</span>, where:</p><ul><li><p><span>$p_1$</span> and <span>$p_2$</span> belong to <span>$S$</span></p></li><li><p>the segments <span>$(p_1 q)$</span> and <span>$(p_2 q)$</span> belong to support lines of <span>$S$</span></p></li></ul><p>Recall that, since <span>$S$</span> is assumed to be convex, the segment <span>$(p_1 p_2)$</span> is inside <span>$S$</span>. The type <code>Approximation2D</code> implements a local approximation in 2D.</p><h2><a class="nav-anchor" id="Initialization-1" href="#Initialization-1">Initialization</a></h2><p>The approximation is initialized with box directions, i.e., we have four refinement instances, one for each angle.</p><p>Let <code>ndir</code> denote the direction normal to the inner approximation.</p><h2><a class="nav-anchor" id="Iteration-1" href="#Iteration-1">Iteration</a></h2><p>Then we just iterate through all refinement instances and check if the error is bigger than the threshold individually. If so, we refine the instance by splitting into two more precise refinement instances and apply the checks recursively.</p><h2><a class="nav-anchor" id="Stopping-criteria-1" href="#Stopping-criteria-1">Stopping criteria</a></h2><h2><a class="nav-anchor" id="Examples-1" href="#Examples-1">Examples</a></h2><p>Consider in two dimensions a centered unit ball in the 2-norm. Let&#39;s consider a polygonal approximation with error bound <span>$ɛ = .01$</span>.</p><div><pre><code class="language-julia">using LazySets, LazySets.Approximations, Plots

b = Ball2(zeros(2), 1.)
ɛ = .5
p = overapproximate(b, ɛ)

plot(b, 1e-3, aspectratio=1)  # use 1e-3 for precise definition of borders
plot!(p, alpha=0.4)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 600 400">
<defs>
  <clipPath id="clip4900">
    <rect x="0" y="0" width="600" height="400"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip4900)" points="
0,400 600,400 600,0 0,0 
  " fill="#ffffff" fill-opacity="1"/>
<defs>
  <clipPath id="clip4901">
    <rect x="120" y="0" width="421" height="400"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip4900)" points="
111.811,384.252 484.252,384.252 484.252,11.811 111.811,11.811 
  " fill="#ffffff" fill-opacity="1"/>
<defs>
  <clipPath id="clip4902">
    <rect x="111" y="11" width="373" height="373"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip4902)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  111.811,384.252 111.811,11.811 
  "/>
<polyline clip-path="url(#clip4902)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  204.921,384.252 204.921,11.811 
  "/>
<polyline clip-path="url(#clip4902)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  298.031,384.252 298.031,11.811 
  "/>
<polyline clip-path="url(#clip4902)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  391.142,384.252 391.142,11.811 
  "/>
<polyline clip-path="url(#clip4902)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  484.252,384.252 484.252,11.811 
  "/>
<polyline clip-path="url(#clip4902)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  111.811,384.252 484.252,384.252 
  "/>
<polyline clip-path="url(#clip4902)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  111.811,291.142 484.252,291.142 
  "/>
<polyline clip-path="url(#clip4902)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  111.811,198.031 484.252,198.031 
  "/>
<polyline clip-path="url(#clip4902)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  111.811,104.921 484.252,104.921 
  "/>
<polyline clip-path="url(#clip4902)" style="stroke:#000000; stroke-width:0.5; stroke-opacity:0.1; fill:none" points="
  111.811,11.811 484.252,11.811 
  "/>
<polyline clip-path="url(#clip4900)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  111.811,384.252 484.252,384.252 
  "/>
<polyline clip-path="url(#clip4900)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  111.811,384.252 111.811,11.811 
  "/>
<polyline clip-path="url(#clip4900)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  111.811,384.252 111.811,378.665 
  "/>
<polyline clip-path="url(#clip4900)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  204.921,384.252 204.921,378.665 
  "/>
<polyline clip-path="url(#clip4900)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  298.031,384.252 298.031,378.665 
  "/>
<polyline clip-path="url(#clip4900)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  391.142,384.252 391.142,378.665 
  "/>
<polyline clip-path="url(#clip4900)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  484.252,384.252 484.252,378.665 
  "/>
<polyline clip-path="url(#clip4900)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  111.811,384.252 117.398,384.252 
  "/>
<polyline clip-path="url(#clip4900)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  111.811,291.142 117.398,291.142 
  "/>
<polyline clip-path="url(#clip4900)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  111.811,198.031 117.398,198.031 
  "/>
<polyline clip-path="url(#clip4900)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  111.811,104.921 117.398,104.921 
  "/>
<polyline clip-path="url(#clip4900)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  111.811,11.811 117.398,11.811 
  "/>
<g clip-path="url(#clip4900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 111.811, 398.052)" x="111.811" y="398.052">-1.0</text>
</g>
<g clip-path="url(#clip4900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 204.921, 398.052)" x="204.921" y="398.052">-0.5</text>
</g>
<g clip-path="url(#clip4900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 298.031, 398.052)" x="298.031" y="398.052">0.0</text>
</g>
<g clip-path="url(#clip4900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 391.142, 398.052)" x="391.142" y="398.052">0.5</text>
</g>
<g clip-path="url(#clip4900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:middle;" transform="rotate(0, 484.252, 398.052)" x="484.252" y="398.052">1.0</text>
</g>
<g clip-path="url(#clip4900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 105.811, 388.752)" x="105.811" y="388.752">-1.0</text>
</g>
<g clip-path="url(#clip4900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 105.811, 295.642)" x="105.811" y="295.642">-0.5</text>
</g>
<g clip-path="url(#clip4900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 105.811, 202.531)" x="105.811" y="202.531">0.0</text>
</g>
<g clip-path="url(#clip4900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 105.811, 109.421)" x="105.811" y="109.421">0.5</text>
</g>
<g clip-path="url(#clip4900)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:12; text-anchor:end;" transform="rotate(0, 105.811, 16.311)" x="105.811" y="16.311">1.0</text>
</g>
<polygon clip-path="url(#clip4902)" points="
484.252,193.46 483.803,184.328 482.907,175.229 481.566,166.185 479.782,157.218 477.56,148.349 474.906,139.6 471.826,130.991 468.327,122.545 464.418,114.279 
  460.108,106.216 455.408,98.374 450.328,90.7719 444.882,83.4283 439.082,76.3607 432.942,69.5862 426.477,63.1212 419.702,56.9812 412.635,51.181 405.291,45.7346 
  397.689,40.6551 389.847,35.9547 381.784,31.6447 373.518,27.7356 365.072,24.2368 356.463,21.1566 347.714,18.5026 338.845,16.281 329.878,14.4974 320.834,13.1558 
  311.735,12.2596 302.603,11.811 293.46,11.811 284.328,12.2596 275.229,13.1558 266.185,14.4974 257.218,16.281 248.349,18.5026 239.6,21.1566 230.991,24.2368 
  222.545,27.7356 214.279,31.6447 206.216,35.9547 198.374,40.6551 190.772,45.7346 183.428,51.181 176.361,56.9812 169.586,63.1212 163.121,69.5862 156.981,76.3607 
  151.181,83.4283 145.735,90.7719 140.655,98.374 135.955,106.216 131.645,114.279 127.736,122.545 124.237,130.991 121.157,139.6 118.503,148.349 116.281,157.218 
  114.497,166.185 113.156,175.229 112.26,184.328 111.811,193.46 111.811,202.603 112.26,211.735 113.156,220.834 114.497,229.878 116.281,238.845 118.503,247.714 
  121.157,256.463 124.237,265.072 127.736,273.518 131.645,281.784 135.955,289.847 140.655,297.689 145.735,305.291 151.181,312.635 156.981,319.702 163.121,326.477 
  169.586,332.942 176.361,339.082 183.428,344.882 190.772,350.328 198.374,355.408 206.216,360.108 214.279,364.418 222.545,368.327 230.991,371.826 239.6,374.906 
  248.349,377.56 257.218,379.782 266.185,381.566 275.229,382.907 284.328,383.803 293.46,384.252 302.603,384.252 311.735,383.803 320.834,382.907 329.878,381.566 
  338.845,379.782 347.714,377.56 356.463,374.906 365.072,371.826 373.518,368.327 381.784,364.418 389.847,360.108 397.689,355.408 405.291,350.328 412.635,344.882 
  419.702,339.082 426.477,332.942 432.942,326.477 439.082,319.702 444.882,312.635 450.328,305.291 455.408,297.689 460.108,289.847 464.418,281.784 468.327,273.518 
  471.826,265.072 474.906,256.463 477.56,247.714 479.782,238.845 481.566,229.878 482.907,220.834 483.803,211.735 484.252,202.603 484.252,193.46 
  " fill="#009af9" fill-opacity="1"/>
<polyline clip-path="url(#clip4902)" style="stroke:#000000; stroke-width:1; stroke-opacity:1; fill:none" points="
  484.252,193.46 483.803,184.328 482.907,175.229 481.566,166.185 479.782,157.218 477.56,148.349 474.906,139.6 471.826,130.991 468.327,122.545 464.418,114.279 
  460.108,106.216 455.408,98.374 450.328,90.7719 444.882,83.4283 439.082,76.3607 432.942,69.5862 426.477,63.1212 419.702,56.9812 412.635,51.181 405.291,45.7346 
  397.689,40.6551 389.847,35.9547 381.784,31.6447 373.518,27.7356 365.072,24.2368 356.463,21.1566 347.714,18.5026 338.845,16.281 329.878,14.4974 320.834,13.1558 
  311.735,12.2596 302.603,11.811 293.46,11.811 284.328,12.2596 275.229,13.1558 266.185,14.4974 257.218,16.281 248.349,18.5026 239.6,21.1566 230.991,24.2368 
  222.545,27.7356 214.279,31.6447 206.216,35.9547 198.374,40.6551 190.772,45.7346 183.428,51.181 176.361,56.9812 169.586,63.1212 163.121,69.5862 156.981,76.3607 
  151.181,83.4283 145.735,90.7719 140.655,98.374 135.955,106.216 131.645,114.279 127.736,122.545 124.237,130.991 121.157,139.6 118.503,148.349 116.281,157.218 
  114.497,166.185 113.156,175.229 112.26,184.328 111.811,193.46 111.811,202.603 112.26,211.735 113.156,220.834 114.497,229.878 116.281,238.845 118.503,247.714 
  121.157,256.463 124.237,265.072 127.736,273.518 131.645,281.784 135.955,289.847 140.655,297.689 145.735,305.291 151.181,312.635 156.981,319.702 163.121,326.477 
  169.586,332.942 176.361,339.082 183.428,344.882 190.772,350.328 198.374,355.408 206.216,360.108 214.279,364.418 222.545,368.327 230.991,371.826 239.6,374.906 
  248.349,377.56 257.218,379.782 266.185,381.566 275.229,382.907 284.328,383.803 293.46,384.252 302.603,384.252 311.735,383.803 320.834,382.907 329.878,381.566 
  338.845,379.782 347.714,377.56 356.463,374.906 365.072,371.826 373.518,368.327 381.784,364.418 389.847,360.108 397.689,355.408 405.291,350.328 412.635,344.882 
  419.702,339.082 426.477,332.942 432.942,326.477 439.082,319.702 444.882,312.635 450.328,305.291 455.408,297.689 460.108,289.847 464.418,281.784 468.327,273.518 
  471.826,265.072 474.906,256.463 477.56,247.714 479.782,238.845 481.566,229.878 482.907,220.834 483.803,211.735 484.252,202.603 484.252,193.46 
  "/>
<polygon clip-path="url(#clip4902)" points="
484.252,11.811 111.811,11.811 111.811,384.252 484.252,384.252 484.252,11.811 
  " fill="#e26f46" fill-opacity="0.4"/>
<polyline clip-path="url(#clip4902)" style="stroke:#000000; stroke-width:1; stroke-opacity:0.4; fill:none" points="
  484.252,11.811 111.811,11.811 111.811,384.252 484.252,384.252 484.252,11.811 
  "/>
</svg>
</div><p>Let&#39;s analyze in some detail how <code>p</code> was actually computed. The &quot;box&quot; directions are used as the initialization.</p><div><pre><code class="language-julia">import LazySets.Approximations:Approximation2D, refine

const DIR_EAST, DIR_NORTH, DIR_WEST, DIR_SOUTH = [1., 0.], [0., 1.], [-1., 0.], [0., -1.]</code></pre><pre><code class="language-none">WARNING: could not import Approximations.Approximation2D into ex-ir
([1.0, 0.0], [0.0, 1.0], [-1.0, 0.0], [0.0, -1.0])</code></pre></div><footer><hr/><a class="previous" href="fast_2d_LPs.html"><span class="direction">Previous</span><span class="title">Fast 2D LPs</span></a><a class="next" href="interval_hulls.html"><span class="direction">Next</span><span class="title">Interval Hulls</span></a></footer></article></body></html>
